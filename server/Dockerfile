FROM python:3-alpine

RUN pip install plotly flask gunicorn

ARG SQLITE3_DB_PATH=/var/lib/sqlite3.db
ENV SQLITE3_DB_PATH=$SQLITE3_DB_PATH

ARG GUNICORN_BINDING=0.0.0.0:4000
ENV GUNICORN_BINDING=$GUNICORN_BINDING

ARG GUNICORN_WORKERS=1
ENV GUNICORN_WORKERS=$GUNICORN_WORKERS

ARG FLASK_ENV=production
ENV FLASK_ENV=$FLASK_ENV

ADD app /var/app
WORKDIR /var/app

CMD gunicorn -w $GUNICORN_WORKERS -b $GUNICORN_BINDING main:app